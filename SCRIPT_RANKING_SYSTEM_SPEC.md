# å‰§æœ¬æ¦œå• & è§’è‰²æ¦œå•ç³»ç»Ÿ - éœ€æ±‚è§„æ ¼è¯´æ˜

## ğŸ“‹ ç‰ˆæœ¬ä¿¡æ¯
- **ç‰ˆæœ¬**: v3.0
- **æ—¥æœŸ**: 2025-10-18
- **ç±»å‹**: æ–°åŠŸèƒ½ - æ¦œå•ç³»ç»Ÿ

---

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

### 1. è¯´ä¹¦äººæ¦œå•
- **ç²‰ä¸æ•°é‡æ¦œå•**ï¼šæŒ‰ç…§è¯´ä¹¦äººç²‰ä¸æ•°æ’åº
- **çƒ­åº¦æ¦œå•**ï¼šæŒ‰ç…§ç»¼åˆçƒ­åº¦ï¼ˆä¸Šä¼ å‰§æœ¬æ•°ã€ç‚¹èµæ•°ã€è¯„è®ºæ•°ç­‰ï¼‰æ’åº

### 2. è§’è‰²æ¦œå•
- **æœ€æ–°è§’è‰²æ¦œå•**ï¼šæŒ‰ç…§åŒæ­¥æ—¶é—´æ’åº
- **æœ€å—æ¬¢è¿æ¦œå•**ï¼šæŒ‰ç…§æ”¶è—æ•°æ’åº
- **ç‚¹èµæ¦œ**ï¼šæŒ‰ç…§ç‚¹èµæ•°æ’åº
- **çƒ­åº¦æ¦œ**ï¼šæŒ‰ç…§ç»¼åˆçƒ­åº¦ï¼ˆæµè§ˆé‡ã€ç‚¹èµã€è¯„è®ºæ•°ç­‰ï¼‰æ’åº

### 3. è§’è‰²äº’åŠ¨
- **è¯„è®ºåŠŸèƒ½**ï¼šç”¨æˆ·å¯ä»¥å¯¹è§’è‰²å‘è¡¨è¯„è®º
- **ç‚¹èµåŠŸèƒ½**ï¼šç”¨æˆ·å¯ä»¥ç‚¹èµè§’è‰²

---

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### wiki_entriesï¼ˆæ‰©å±•ï¼‰
```javascript
{
  _id: String,
  title: String,
  entry_type: String,
  
  // ğŸ†• æ‰©å±•å­—æ®µ
  stats: {
    view_count: Number,      // æµè§ˆé‡
    favorite_count: Number,  // æ”¶è—æ•°
    like_count: Number,      // ğŸ†• ç‚¹èµæ•°
    comment_count: Number    // ğŸ†• è¯„è®ºæ•°
  },
  
  // ğŸ†• çƒ­åº¦åˆ†æ•°ï¼ˆè‡ªåŠ¨è®¡ç®—ï¼‰
  heat_score: Number
}
```

### wiki_role_likesï¼ˆæ–°å¢ï¼‰
```javascript
{
  _id: String,
  user_id: String,         // ç”¨æˆ·ID
  role_id: String,         // è§’è‰²IDï¼ˆwiki_entries._idï¼‰
  created_at: Date         // ç‚¹èµæ—¶é—´
}
```

### wiki_role_commentsï¼ˆæ–°å¢ï¼‰
```javascript
{
  _id: String,
  user_id: String,         // ç”¨æˆ·ID
  user_nickname: String,   // ç”¨æˆ·æ˜µç§°
  user_avatar: String,     // ç”¨æˆ·å¤´åƒ
  role_id: String,         // è§’è‰²ID
  content: String,         // è¯„è®ºå†…å®¹
  like_count: Number,      // è¯„è®ºç‚¹èµæ•°
  created_at: Date,        // è¯„è®ºæ—¶é—´
  status: Number           // çŠ¶æ€ï¼š1æ­£å¸¸ï¼Œ0éšè—
}
```

### uni-id-usersï¼ˆæ‰©å±• - è¯´ä¹¦äººä¿¡æ¯ï¼‰
```javascript
{
  _id: String,
  nickname: String,
  avatar_file: Object,
  
  // ğŸ†• è¯´ä¹¦äººç»Ÿè®¡
  storyteller_stats: {
    fans_count: Number,      // ç²‰ä¸æ•°
    script_count: Number,    // ä¸Šä¼ å‰§æœ¬æ•°
    like_count: Number,      // è·èµæ•°
    heat_score: Number       // çƒ­åº¦åˆ†æ•°
  }
}
```

---

## ğŸ¨ å‰ç«¯é¡µé¢è®¾è®¡

### 1. æ¦œå•é¡µé¢ï¼ˆæ–°å¢ï¼‰
**è·¯å¾„**: `pages/ranking/index.vue`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¦œå•                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [è¯´ä¹¦äººæ¦œ] [è§’è‰²æ¦œ]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ç²‰ä¸æ¦œ] [çƒ­åº¦æ¦œ]                â”‚  â† è¯´ä¹¦äººæ¦œå•çš„tab
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. [ğŸ‘¤å¤´åƒ] å¼ ä¸‰                 â”‚
â”‚    ç²‰ä¸ï¼š1234 | å‰§æœ¬ï¼š56         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. [ğŸ‘¤å¤´åƒ] æå››                 â”‚
â”‚    ç²‰ä¸ï¼š987 | å‰§æœ¬ï¼š43          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

æˆ–åˆ‡æ¢åˆ°è§’è‰²æ¦œï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¦œå•                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [è¯´ä¹¦äººæ¦œ] [è§’è‰²æ¦œ]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [æœ€æ–°] [æœ€å—æ¬¢è¿] [ç‚¹èµ] [çƒ­åº¦] â”‚  â† è§’è‰²æ¦œå•çš„tab
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. [ğŸ­å›¾æ ‡] å›¾ä¹¦ç®¡ç†å‘˜           â”‚
â”‚    â¤ï¸ 123 | ğŸ’¬ 45 | ğŸ‘ï¸ 678      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. [ğŸ­å›¾æ ‡] å“²å­¦å®¶               â”‚
â”‚    â¤ï¸ 98 | ğŸ’¬ 32 | ğŸ‘ï¸ 456       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. è§’è‰²è¯¦æƒ…é¡µï¼ˆæ‰©å±•ï¼‰
**è·¯å¾„**: `pages/tools/wiki/detail.vue`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [å›¾æ ‡] å›¾ä¹¦ç®¡ç†å‘˜  [é•‡æ°‘]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ... è§’è‰²è¯¦ç»†ä¿¡æ¯ ...            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’¬ è¯„è®º (45)        [â¤ï¸ ç‚¹èµ 123]â”‚  â† æ–°å¢äº’åŠ¨åŒº
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ‘¤] å¼ ä¸‰ï¼šè¿™ä¸ªè§’è‰²å¾ˆå¼º          â”‚
â”‚      2å°æ—¶å‰  â¤ï¸ 12              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ‘¤] æå››ï¼šé€‚åˆæ–°æ‰‹              â”‚
â”‚      5å°æ—¶å‰  â¤ï¸ 8               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ“ å†™è¯„è®º]                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸŒ è·³è½¬ç™¾ç§‘åœ°å€]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ äº¤äº’é€»è¾‘

### ç‚¹èµè§’è‰²
```
1. ç”¨æˆ·ç‚¹å‡»"â¤ï¸ ç‚¹èµ"æŒ‰é’®
2. æ£€æŸ¥æ˜¯å¦å·²ç‚¹èµ
3. å¦‚æœæœªç‚¹èµï¼š
   - æ’å…¥ wiki_role_likes è®°å½•
   - wiki_entries.stats.like_count +1
   - æ›´æ–°æŒ‰é’®çŠ¶æ€ä¸º"å·²ç‚¹èµ"
4. å¦‚æœå·²ç‚¹èµï¼š
   - åˆ é™¤ wiki_role_likes è®°å½•
   - wiki_entries.stats.like_count -1
   - æ›´æ–°æŒ‰é’®çŠ¶æ€ä¸º"ç‚¹èµ"
```

### å‘è¡¨è¯„è®º
```
1. ç”¨æˆ·ç‚¹å‡»"ğŸ“ å†™è¯„è®º"
2. å¼¹å‡ºè¯„è®ºè¾“å…¥æ¡†
3. è¾“å…¥è¯„è®ºå†…å®¹ï¼ˆé™åˆ¶200å­—ï¼‰
4. æäº¤è¯„è®ºï¼š
   - æ’å…¥ wiki_role_comments
   - wiki_entries.stats.comment_count +1
   - åˆ·æ–°è¯„è®ºåˆ—è¡¨
```

### çƒ­åº¦è®¡ç®—
```javascript
heat_score = 
  view_count * 1 +        // æµè§ˆé‡æƒé‡1
  like_count * 5 +        // ç‚¹èµæƒé‡5
  favorite_count * 10 +   // æ”¶è—æƒé‡10
  comment_count * 15      // è¯„è®ºæƒé‡15
```

---

## ğŸ› ï¸ å¼€å‘ä»»åŠ¡æ¸…å•

### æ•°æ®åº“å¼€å‘ï¼ˆ4ä¸ªä»»åŠ¡ï¼‰
1. [ ] æ‰©å±• wiki_entries Schemaï¼ˆæ·»åŠ like_count, comment_count, heat_scoreï¼‰
2. [ ] åˆ›å»º wiki_role_likes Schema
3. [ ] åˆ›å»º wiki_role_comments Schema
4. [ ] æ‰©å±• uni-id-usersï¼ˆæ·»åŠ storyteller_statsï¼‰

### äº‘å‡½æ•°å¼€å‘ï¼ˆ8ä¸ªä»»åŠ¡ï¼‰
5. [ ] wiki-role-likeï¼ˆç‚¹èµ/å–æ¶ˆç‚¹èµï¼‰
6. [ ] wiki-role-comment-addï¼ˆå‘è¡¨è¯„è®ºï¼‰
7. [ ] wiki-role-comment-listï¼ˆè¯„è®ºåˆ—è¡¨ï¼‰
8. [ ] wiki-role-comment-likeï¼ˆè¯„è®ºç‚¹èµï¼‰
9. [ ] wiki-ranking-rolesï¼ˆè§’è‰²æ¦œå•ï¼‰
10. [ ] wiki-ranking-storytellersï¼ˆè¯´ä¹¦äººæ¦œå•ï¼‰
11. [ ] wiki-update-heat-scoreï¼ˆå®šæ—¶æ›´æ–°çƒ­åº¦åˆ†æ•°ï¼‰
12. [ ] wiki-check-like-statusï¼ˆæ£€æŸ¥ç‚¹èµçŠ¶æ€ï¼‰

### å‰ç«¯å¼€å‘ï¼ˆ6ä¸ªä»»åŠ¡ï¼‰
13. [ ] åˆ›å»º pages/ranking/index.vueï¼ˆæ¦œå•é¡µé¢ï¼‰
14. [ ] detail.vue æ·»åŠ è¯„è®ºåŒºåŸŸ
15. [ ] detail.vue æ·»åŠ ç‚¹èµæŒ‰é’®
16. [ ] è¯„è®ºè¾“å…¥ç»„ä»¶
17. [ ] æ¦œå•åˆ—è¡¨ç»„ä»¶
18. [ ] å¯¼èˆªèœå•æ·»åŠ "æ¦œå•"å…¥å£

### æµ‹è¯•ä»»åŠ¡ï¼ˆ4ä¸ªï¼‰
19. [ ] æµ‹è¯•ç‚¹èµåŠŸèƒ½
20. [ ] æµ‹è¯•è¯„è®ºåŠŸèƒ½
21. [ ] æµ‹è¯•æ¦œå•æ˜¾ç¤º
22. [ ] æµ‹è¯•çƒ­åº¦è®¡ç®—

---

## â±ï¸ å¼€å‘æ—¶é—´ä¼°ç®—

| åˆ†ç±» | ä»»åŠ¡æ•° | é¢„è®¡æ—¶é—´ |
|------|-------|---------|
| æ•°æ®åº“ | 4 | 1.5å°æ—¶ |
| äº‘å‡½æ•° | 8 | 4å°æ—¶ |
| å‰ç«¯ | 6 | 5å°æ—¶ |
| æµ‹è¯• | 4 | 1.5å°æ—¶ |
| **æ€»è®¡** | **22** | **12å°æ—¶** |

---

## ğŸ“ å¤‡æ³¨

è¿™æ˜¯ä¸€ä¸ªè¾ƒå¤§çš„åŠŸèƒ½æ¨¡å—ï¼Œå»ºè®®åˆ†é˜¶æ®µå¼€å‘ï¼š

### é˜¶æ®µ1: è§’è‰²äº’åŠ¨ï¼ˆä¼˜å…ˆï¼‰
- ç‚¹èµåŠŸèƒ½
- è¯„è®ºåŠŸèƒ½
- è¯„è®ºåˆ—è¡¨å±•ç¤º

### é˜¶æ®µ2: è§’è‰²æ¦œå•
- æœ€æ–°è§’è‰²æ¦œ
- ç‚¹èµæ¦œ
- çƒ­åº¦æ¦œ

### é˜¶æ®µ3: è¯´ä¹¦äººæ¦œå•
- ç²‰ä¸æ¦œ
- çƒ­åº¦æ¦œ

---

## ğŸ¯ ä¸‹ä¸€æ­¥

éœ€è¦å¼€å§‹å¼€å‘å—ï¼Ÿå›å¤ï¼š
- **/implement** - ç«‹å³å¼€å§‹å®Œæ•´å¼€å‘ï¼ˆ12å°æ—¶ï¼‰
- **é˜¶æ®µ1** - å…ˆå¼€å‘è§’è‰²äº’åŠ¨åŠŸèƒ½ï¼ˆ4å°æ—¶ï¼‰
- **è§„åˆ’** - ç»§ç»­ç»†åŒ–éœ€æ±‚

