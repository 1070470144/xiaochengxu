# Wiki v2.2 角色管理系统使用说明

## 🚀 快速开始

### 第一步：部署系统
请先完成部署，详见：[WIKI_V2.2_DEPLOYMENT_GUIDE.md](../WIKI_V2.2_DEPLOYMENT_GUIDE.md)

### 第二步：添加角色
1. 打开"百科同步管理"页面
2. 在"添加角色"输入框中输入角色名称，例如：
   ```
   图书管理员
   哲学家
   洗衣妇
   守鸦人
   僧侣
   ```
3. 点击"保存角色"按钮
4. 等待提示"添加完成"

### 第三步：同步角色
1. 勾选要同步的角色（可以勾选多个）
2. 点击"批量同步"按钮
3. 确认同步
4. 等待同步完成

---

## 📖 功能说明

### 1️⃣ 添加角色
**功能**：将角色名称保存到数据库，生成对应的URL

**操作方法**：
- 在输入框中输入角色名称
- 支持多个角色（用逗号、换行、分号分隔）
- 点击"保存角色"

**示例**：
```
图书管理员,哲学家,洗衣妇
```
或
```
图书管理员
哲学家
洗衣妇
```

**注意事项**：
- ⚠️ 角色名称必须与钟楼百科完全一致
- ⚠️ 不支持别名
- ⚠️ 重复的角色会自动跳过

---

### 2️⃣ 搜索角色
**功能**：按角色名称快速查找

**操作方法**：
- 在搜索框中输入关键词
- 自动显示匹配的角色（500ms防抖）

**示例**：
- 输入"图书" → 显示"图书管理员"
- 输入"家" → 显示"哲学家"、"赌徒"等

---

### 3️⃣ 状态筛选
**功能**：按同步状态筛选角色

**操作方法**：
- 点击筛选下拉框
- 选择状态：
  - **全部状态**：显示所有角色
  - **已同步**：只显示已成功同步的角色
  - **未同步**：只显示尚未同步的角色
  - **同步失败**：只显示同步失败的角色

---

### 4️⃣ 单个同步
**功能**：同步单个角色的数据

**操作方法**：
1. 找到要同步的角色
2. 点击该角色行的"同步"按钮
3. 确认同步
4. 等待完成（通常2-5秒）

**同步内容**：
- 角色名称
- 角色类型
- 角色能力
- 背景故事
- 角色简介
- 角色图标

---

### 5️⃣ 批量同步
**功能**：一次性同步多个角色

**操作方法**：
1. 勾选要同步的角色（点击复选框）
2. 点击顶部"批量同步（N）"按钮
3. 确认同步
4. 等待完成

**批量操作技巧**：
- 点击表头复选框可全选/取消全选
- 建议每次不超过50个角色
- 失败的角色可以单独重试

**预计时间**：
- 1个角色：2-5秒
- 10个角色：20-50秒
- 50个角色：2-5分钟

---

### 6️⃣ 删除角色
**功能**：从列表中删除不需要的角色

**操作方法**：
- **删除单个**：点击角色行的"删除"按钮
- **批量删除**：勾选多个角色 → 点击"批量删除（N）"

**注意事项**：
- ⚠️ 删除后无法恢复
- ⚠️ 删除角色不会删除wiki_entries中的同步数据
- ⚠️ 如需重新添加，直接输入角色名称即可

---

## 🎯 使用场景

### 场景1：首次使用
**目标**：批量添加并同步常用角色

**步骤**：
1. 准备角色列表（例如：基础版24个角色）
2. 复制粘贴到输入框
3. 点击"保存角色"
4. 全选角色
5. 点击"批量同步"
6. 等待完成

**预计时间**：5-10分钟

---

### 场景2：新增单个角色
**目标**：添加并同步一个新角色

**步骤**：
1. 输入角色名称，例如："恶魔猎手"
2. 点击"保存角色"
3. 找到新角色
4. 点击"同步"按钮
5. 完成

**预计时间**：1分钟

---

### 场景3：更新已有角色
**目标**：重新同步某个角色的最新数据

**步骤**：
1. 搜索角色名称
2. 点击该角色的"同步"按钮
3. 完成

**预计时间**：30秒

---

### 场景4：批量更新未同步角色
**目标**：将所有未同步的角色一次性同步

**步骤**：
1. 筛选"未同步"
2. 全选
3. 批量同步
4. 完成

**预计时间**：根据数量而定

---

## 📊 状态说明

### 角色状态类型

| 状态 | 颜色 | 说明 |
|------|------|------|
| **已同步** | 🟢 绿色 | 角色已成功同步到wiki_entries |
| **未同步** | ⚪ 灰色 | 角色已添加但尚未同步 |
| **同步失败** | 🔴 红色 | 同步过程中出现错误 |

### 查看同步时间
- 每个角色都会显示"最后同步时间"
- 格式：`2025-10-18 14:30`
- 未同步的角色显示：`-`

### 查看错误信息
- 同步失败的角色会显示错误原因
- 鼠标悬停在状态标签上可查看详情
- 常见错误：页面不存在、网络超时等

---

## 💡 使用技巧

### 技巧1：批量添加角色
从Excel或文本文档复制角色列表，直接粘贴到输入框：
```
图书管理员
哲学家
洗衣妇
守鸦人
僧侣
...
```

### 技巧2：组合筛选
先按状态筛选，再搜索：
1. 筛选"未同步"
2. 搜索"家"
3. 只显示未同步的包含"家"的角色

### 技巧3：定期维护
建议每月：
1. 筛选"同步失败"
2. 检查错误原因
3. 删除无效角色或重新同步

### 技巧4：验证同步结果
同步后可以：
1. 打开小程序前端
2. 搜索该角色
3. 查看是否显示正常

---

## 🔍 常见问题

### Q1: 添加角色后列表不显示？
**A**: 检查以下几点：
1. 浏览器控制台是否有错误
2. 云函数是否部署成功
3. 手动刷新页面

### Q2: 同步失败怎么办？
**A**: 
1. 查看错误信息（鼠标悬停状态标签）
2. 检查角色名称是否正确
3. 手动访问钟楼百科验证页面是否存在
4. 重试同步

### Q3: 同步速度慢？
**A**: 
1. 减少每次批量同步的数量
2. 避免在网络高峰期同步
3. 单个同步速度应在2-5秒内

### Q4: 重复添加了角色？
**A**: 
1. 系统会自动跳过重复角色
2. 不会在数据库中创建重复记录
3. 可以安全忽略

### Q5: 删除角色后能恢复吗？
**A**: 
1. 不能恢复（数据库中已删除）
2. 需要重新添加
3. 已同步的数据仍在wiki_entries中

---

## 📈 性能参考

### 响应时间
| 操作 | 预计时间 |
|------|----------|
| 添加1个角色 | < 500ms |
| 添加10个角色 | < 2s |
| 搜索角色 | < 300ms |
| 筛选状态 | < 200ms |
| 单个同步 | 2-5s |
| 批量同步10个 | 20-50s |
| 删除角色 | < 500ms |

### 推荐配置
- **单次添加**：不超过100个角色
- **单次同步**：不超过50个角色
- **列表显示**：20条/页（可根据需要调整）

---

## 🎨 界面说明

### 顶部统计卡片
显示数据库中的词条统计：
- 总词条
- 角色数
- 剧本数
- 规则数

### 角色管理区域
- **添加角色输入框**：支持多行输入
- **保存角色按钮**：添加到数据库
- **清空按钮**：清空输入框

### 搜索筛选区域
- **搜索框**：按名称搜索
- **状态筛选**：下拉选择状态

### 角色列表
- **表头**：复选框、角色名称、状态、最后同步时间、操作
- **表行**：每个角色一行
- **批量操作**：顶部显示批量同步和批量删除按钮

### 分页
- **上一页/下一页**：切换页面
- **页码显示**：当前页/总页数

---

## 📞 获取帮助

### 查看日志
1. 打开浏览器控制台（F12）
2. 切换到Console标签
3. 查看操作日志

### 查看云函数日志
1. 登录uniCloud Web控制台
2. 进入"云函数/云对象"
3. 点击云函数名称
4. 查看运行日志

### 查看数据库
1. 登录uniCloud Web控制台
2. 进入"数据库"
3. 选择"wiki_role_list"
4. 查看记录

---

## 🎉 开始使用

现在你已经了解了Wiki v2.2的所有功能，开始使用吧！

**建议步骤**：
1. ✅ 添加10-20个常用角色
2. ✅ 批量同步
3. ✅ 验证前端显示
4. ✅ 定期维护更新

**祝你使用愉快！** 🚀

---

**更新时间**: 2025-10-18  
**版本**: v2.2  
**文档状态**: ✅ 完整

