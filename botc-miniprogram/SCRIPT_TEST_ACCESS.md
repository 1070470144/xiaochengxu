# 🧪 Script 云对象测试页面访问指南

## 🌐 直接访问 URL

### Script 测试页面（新建）
```
http://localhost:5173/#/pages/test/script-test
```

### User 测试页面（原有）
```
http://localhost:5173/#/pages/test/user-test-complete
```

---

## 📋 Script 测试页面功能

### ✅ 已实现的测试（5个方法）

#### 1️⃣ 剧本列表 (getList)
**功能：**
- 分页查询
- 关键词搜索
- 排序切换（最新/热门/高分/下载量）

**测试步骤：**
1. 设置页码和每页数量
2. 可选：输入搜索关键词
3. 选择排序方式
4. 点击"获取剧本列表"

**预期结果：**
- 显示剧本总数
- 显示第一个剧本信息
- 自动填充剧本ID到详情测试

---

#### 2️⃣ 剧本详情 (getDetail)
**功能：**
- 查看剧本完整信息
- 自动增加浏览量

**测试步骤：**
1. 输入剧本ID（可以从列表获取）
2. 点击"查看详情"

**预期结果：**
- 显示剧本标题、作者
- 显示浏览量
- 显示创建者信息
- 显示状态（0-待审核，1-已发布）

---

#### 3️⃣ 上传剧本 (upload)
**功能：**
- 上传新剧本
- 自动生成预览图

**测试步骤：**
1. ⚠️ 确保已登录
2. 输入剧本标题
3. 输入作者
4. 输入描述（可选）
5. 勾选"使用测试JSON数据"
6. 点击"上传剧本"

**预期结果：**
- 显示"上传成功"
- 返回剧本ID
- 返回预览图生成状态
- 自动填充ID到删除测试

---

#### 4️⃣ 我的剧本 (getMyUploads)
**功能：**
- 查看我上传的所有剧本
- 支持分页

**测试步骤：**
1. ⚠️ 确保已登录
2. 设置页码和每页数量
3. 点击"获取我的剧本"

**预期结果：**
- 显示剧本总数
- 显示剧本列表（含ID、标题、状态）

---

#### 5️⃣ 删除剧本 (delete)
**功能：**
- 删除自己上传的剧本
- 软删除

**测试步骤：**
1. ⚠️ 确保已登录
2. 输入要删除的剧本ID（从上传或我的剧本获取）
3. 点击"删除剧本"
4. 确认删除

**预期结果：**
- 显示"删除成功"
- 已发布的剧本无法删除
- 他人的剧本无法删除

---

## 🎨 界面特点

### 🔴 红色主题
- 区别于 User 测试页面的紫色
- 渐变色：#ff6b6b → #ee5a6f

### 📊 实时结果展示
- 显示成功/失败状态
- 显示返回数据（截断长内容）
- 控制台详细日志

### 🔐 登录状态提示
- 顶部显示登录状态
- 需登录的功能自动禁用

---

## 🧪 完整测试流程

### 步骤 1：准备工作
1. 确保已登录（访问 User 测试页面登录）
2. 访问 Script 测试页面

### 步骤 2：测试列表查询
1. 获取剧本列表（默认参数）
2. 尝试搜索关键词
3. 切换排序方式

### 步骤 3：测试详情查看
1. 从列表获取剧本ID（自动填充）
2. 查看剧本详情
3. 验证浏览量是否增加

### 步骤 4：测试上传功能
1. 填写剧本信息
2. 使用测试JSON上传
3. 记录返回的剧本ID

### 步骤 5：测试我的剧本
1. 获取我的剧本列表
2. 验证刚上传的剧本是否在列表中

### 步骤 6：测试删除功能
1. 使用刚上传的剧本ID
2. 删除剧本
3. 验证删除成功

---

## 📝 测试数据

### 测试剧本JSON
```json
{
  "meta": [
    { "id": 1, "name": "恶魔", "team": "恶魔", "ability": "测试能力" },
    { "id": 2, "name": "爪牙", "team": "爪牙", "ability": "测试能力" },
    { "id": 3, "name": "外来者", "team": "外来者", "ability": "测试能力" },
    { "id": 4, "name": "镇民", "team": "镇民", "ability": "测试能力" }
  ],
  "name": "测试剧本"
}
```

### 默认测试值
- 标题：`测试剧本`
- 作者：`测试作者`
- 描述：`这是一个测试剧本`
- 页码：`1`
- 每页数量：`10`

---

## ⚠️ 注意事项

### 1. 登录要求
以下功能需要登录：
- ❌ 上传剧本
- ❌ 我的剧本
- ❌ 删除剧本

### 2. 权限限制
- 只能删除自己的剧本
- 只能删除未发布的剧本
- 待审核剧本只有创建者可见

### 3. 数据说明
- 列表不返回完整JSON（节省带宽）
- 详情返回完整JSON数据
- 返回数据过长会自动截断显示

---

## 🔍 调试技巧

### 1. 查看控制台
所有操作都会在浏览器控制台输出详细日志：
```javascript
✅ 获取成功 {data}
❌ 获取失败 {error}
```

### 2. 查看云函数日志
在 HBuilderX 中：
```
uniCloud → 云函数/云对象日志
```

### 3. 检查返回数据
页面顶部的"最后测试结果"会显示返回数据

---

## 🐛 常见问题

### 问题 1：提示"请先登录"
**解决：** 访问 User 测试页面完成登录

### 问题 2：找不到剧本
**解决：** 先上传一个测试剧本

### 问题 3：无法删除剧本
**原因：**
- 剧本已发布
- 不是自己的剧本
- 剧本不存在

### 问题 4：上传失败
**检查：**
- 是否已登录
- 标题和作者是否填写
- 云对象是否已上传

---

## 📊 测试检查清单

### 核心功能（必测）
- [ ] 获取剧本列表（默认）
- [ ] 获取剧本列表（搜索）
- [ ] 获取剧本列表（排序）
- [ ] 查看剧本详情
- [ ] 上传剧本
- [ ] 获取我的剧本
- [ ] 删除剧本

### 权限测试
- [ ] 未登录访问公开接口
- [ ] 未登录访问需登录接口（应失败）
- [ ] 查看他人未发布剧本（应失败）
- [ ] 删除他人剧本（应失败）
- [ ] 删除已发布剧本（应失败）

---

## 🚀 快速开始

### 1. 上传云对象
```
HBuilderX → 右键 script 文件夹 → 上传部署
```

### 2. 访问测试页面
```
http://localhost:5173/#/pages/test/script-test
```

### 3. 确保已登录
如未登录，先访问：
```
http://localhost:5173/#/pages/test/user-test-complete
```

### 4. 开始测试
按照页面顺序逐个测试功能

---

## 📞 问题反馈

测试中遇到问题：
1. 查看浏览器控制台
2. 查看云函数日志
3. 检查云对象是否已上传
4. 确认登录状态

---

**现在可以开始测试 Script 云对象了！** 🎬

访问地址：
```
http://localhost:5173/#/pages/test/script-test
```

