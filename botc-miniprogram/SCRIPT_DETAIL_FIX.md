# å‰§æœ¬è¯¦æƒ…é¡µé¢ä¿®å¤è¯´æ˜

## âŒ åŸé—®é¢˜

**ç—‡çŠ¶**: ä¸Šä¼ å‰§æœ¬åï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…æŠ¥é”™"å‰§æœ¬åŠ è½½å¤±è´¥"

**åŸå› **: 
1. å‰§æœ¬è¯¦æƒ…äº‘å‡½æ•°åªæŸ¥è¯¢ `status: 1`ï¼ˆå·²å‘å¸ƒï¼‰çš„å‰§æœ¬
2. ç”¨æˆ·åˆšä¸Šä¼ çš„å‰§æœ¬æ˜¯ `status: 0`ï¼ˆå¾…å®¡æ ¸ï¼‰
3. å¾…å®¡æ ¸å‰§æœ¬æŸ¥è¯¢ä¸åˆ° â†’ æŠ¥é”™

---

## âœ… è§£å†³æ–¹æ¡ˆ

### ä¿®æ”¹æƒé™é€»è¾‘

**æ–°è§„åˆ™**:
- âœ… `status: 1`ï¼ˆå·²å‘å¸ƒï¼‰â†’ æ‰€æœ‰äººéƒ½å¯ä»¥çœ‹
- âœ… `status: 0`ï¼ˆå¾…å®¡æ ¸ï¼‰â†’ **ä»…ä¸Šä¼ è€…æœ¬äººå¯ä»¥çœ‹**
- âœ… `status: 2`ï¼ˆå·²æ‹’ç»ï¼‰â†’ **ä»…ä¸Šä¼ è€…æœ¬äººå¯ä»¥çœ‹**

**å®ç°**:
```javascript
// 1. è·å–å½“å‰ç”¨æˆ·ID
const currentUserId = token.split('_')[0]

// 2. æŸ¥è¯¢å‰§æœ¬
const script = await db.collection('botc-scripts').doc(id).get()

// 3. æƒé™åˆ¤æ–­
const isPublished = script.status === 1  // å·²å‘å¸ƒ
const isOwner = script.creator_id === currentUserId  // æ˜¯æœ¬äºº

// 4. å†³å®šæ˜¯å¦å…è®¸è®¿é—®
if (!isPublished && !isOwner) {
  return { code: 403, message: 'è¯¥å‰§æœ¬æš‚æœªå‘å¸ƒ' }
}

// 5. å…è®¸è®¿é—®ï¼Œè¿”å›æ•°æ®
return { code: 0, data: script }
```

---

## ğŸ“‹ ä¿®æ”¹çš„æ–‡ä»¶

### äº‘å‡½æ•°
- âœ… `cloudfunctions/script-detail/index.js` - ä¿®æ”¹æƒé™é€»è¾‘

### å‰
