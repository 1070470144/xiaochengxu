{
  "bsonType": "object",
  "description": "私聊消息表",
  "required": ["conversation_id", "sender_id", "receiver_id", "content"],
  "permission": {
    "read": true,
    "create": true,
    "update": false,
    "delete": false
  },
  "properties": {
    "_id": {
      "description": "消息ID"
    },
    "conversation_id": {
      "bsonType": "string",
      "description": "会话ID",
      "foreignKey": "botc-chat-conversations._id"
    },
    "sender_id": {
      "bsonType": "string",
      "description": "发送者ID",
      "foreignKey": "uni-id-users._id"
    },
    "receiver_id": {
      "bsonType": "string",
      "description": "接收者ID",
      "foreignKey": "uni-id-users._id"
    },
    "content": {
      "bsonType": "string",
      "description": "消息内容",
      "trim": "both",
      "minLength": 1,
      "maxLength": 1000,
      "errorMessage": {
        "minLength": "消息内容不能为空",
        "maxLength": "消息内容不能超过1000字"
      }
    },
    "message_type": {
      "bsonType": "int",
      "description": "消息类型：1-文本 2-图片 3-语音",
      "enum": [1, 2, 3],
      "defaultValue": 1
    },
    "is_read": {
      "bsonType": "bool",
      "description": "是否已读",
      "defaultValue": false
    },
    "created_at": {
      "bsonType": "timestamp",
      "description": "发送时间",
      "forceDefaultValue": {
        "$env": "now"
      }
    }
  }
}
